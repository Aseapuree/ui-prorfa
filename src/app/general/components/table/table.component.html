<div class="flex flex-col">
  <div class="table-container overflow-x-auto shadow-sm">
    <div class="inline-block min-w-full py-2 align-middle">
      <div
        class="overflow-hidden border border-gray-200 dark:border-gray-700 md:rounded-lg"
      >
        <table
          class="min-w-full table-auto divide-y divide-gray-200 dark:divide-gray-700"
        >
          <!-- Sección de encabezado de la tabla -->
          <thead class="bg-table-header-bg">
  <tr>
    <!-- Encabezados de la tabla -->
    <th
      *ngFor="let column of columns"
      class="py-3.5 px-4 md:px-2 text-sm font-normal text-center text-table-header-text max-w-[{{ column.maxWidth }}px] relative"
      [ngClass]="{
        'pr-8 md:pr-4': column.sortable,
        'cursor-pointer': column.sortable
      }"
      (click)="column.sortable && onSort(column.field)"
    >
      {{ column.header }}
      <fa-icon
        *ngIf="column.sortable"
        [icon]="
          sortBy === column.field
            ? sortDir === 'asc'
              ? ['fas', 'arrow-up']
              : ['fas', 'arrow-down']
            : ['fas', 'sort']
        "
        class="absolute top-1/2 right-2 md:right-1 -translate-y-1/2 h-3 w-3 text-gray-500 hover:text-primary-hover dark:text-gray-400 dark:hover:text-primary-hover"
      ></fa-icon>
    </th>
    <!-- Columna de acciones -->
    <th
      *ngIf="enableActions && actions.length > 0"
      class="py-3.5 px-4 md:px-2 text-sm font-normal text-center text-table-header-text max-w-[100px] relative"
    >
      ACCIONES
    </th>
  </tr>
</thead>
          <!-- Sección de datos de la tabla -->
          <tbody
            class="bg-table-row-bg divide-y divide-gray-200 dark:divide-gray-700 dark:bg-table-row-bg"
          >
            <tr *ngFor="let item of data">
              <!-- Datos de cada fila -->
              <td
                *ngFor="let column of columns"
                class="px-4 md:px-2 py-4 text-sm text-table-row-text max-w-[{{
                  column.maxWidth
                }}px] truncate"
              >
                <ng-container
                  *ngIf="column.type === 'date'; else defaultContent"
                >
                  {{ item[column.field] | date : "yyyy-MM-dd HH:mm" }}
                </ng-container>
                <ng-template #defaultContent>
                  <ng-container *ngIf="column.transform; else simpleText">
                    <ng-container
                      *ngIf="
                        column.field === 'competencias';
                        else transformedText
                      "
                    >
                      <span
                        class="cursor-pointer hover:text-blue-600"
                        (click)="showCompetenciasModal(item)"
                        [innerHTML]="
                          column.transform(item[column.field]) | safeHtml
                        "
                      ></span>
                    </ng-container>
                    <ng-template #transformedText>
                      {{ column.transform(item[column.field]) }}
                    </ng-template>
                  </ng-container>
                  <ng-template #simpleText>
                    {{ item[column.field] }}
                  </ng-template>
                </ng-template>
              </td>
              <!-- Columna de acciones -->
              <td
                *ngIf="enableActions && actions.length > 0"
                class="px-4 md:px-2 py-4 text-sm max-w-[100px]"
              >
                <div class="flex items-center gap-x-6 md:gap-x-3">
                  <ng-container *ngFor="let action of actions">
                    <!-- CAMBIO: Se añadió *ngIf para controlar la visibilidad de la acción. -->
                    <app-tooltip
                      [tooltipText]="action.tooltip"
                      *ngIf="!action.visible || action.visible(item)"
                    >
                      <button
                        (click)="action.action(item)"
                        class="text-table-action-icon transition-colors duration-200"
                        [ngClass]="
                          action.hoverColor
                            ? 'hover:text-' + action.hoverColor
                            : 'hover:text-primary-hover'
                        "
                      >
                        <fa-icon [icon]="action.icon" class="h-8 w-8"></fa-icon>
                      </button>
                    </app-tooltip>
                  </ng-container>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
