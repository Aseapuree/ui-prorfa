<mat-dialog-content class="p-6 bg-gray-800 dark:bg-gray-800 text-gray-100 dark:text-gray-100 rounded-none">
  <h2 class="text-2xl font-semibold mb-6 text-gray-100 dark:text-gray-100">{{ esEdicion ? 'Editar Actividad' : 'Agregar Actividad' }}</h2>
  <form [formGroup]="formulario" (ngSubmit)="agregarContenido()" class="space-y-6 border border-gray-700 dark:border-gray-700 rounded-lg p-6">
    <!-- Campo de nombre -->
    <mat-form-field appearance="outline" class="w-full">
      <mat-label class="text-gray-400 dark:text-gray-400">Nombre</mat-label>
      <input matInput formControlName="nombre" required class="bg-gray-800 dark:bg-gray-800 text-gray-100 dark:text-gray-100" />
      <mat-error *ngIf="formulario.get('nombre')?.hasError('required')">El nombre es obligatorio</mat-error>
    </mat-form-field>

    <!-- Campo de fecha y hora de inicio (solo para actividades) -->
    <div *ngIf="tipoContenido === 'actividades'" class="flex space-x-4">
      <mat-form-field appearance="outline" class="w-1/2">
        <mat-label class="text-gray-400 dark:text-gray-400">Fecha de Inicio</mat-label>
        <input
          matInput
          [matDatepicker]="pickerInicio"
          formControlName="fechaInicio"
          required
          class="bg-gray-800 dark:bg-gray-800 text-gray-100 dark:text-gray-100"
          (dateChange)="onDateChange('fechaInicio', $event)"
        />
        <mat-datepicker-toggle matSuffix [for]="pickerInicio" class="text-white">
          <!-- Icono del calendario ahora será blanco -->
        </mat-datepicker-toggle>
        <mat-datepicker #pickerInicio></mat-datepicker>
        <mat-error *ngIf="formulario.get('fechaInicio')?.hasError('required')">La fecha de inicio es obligatoria</mat-error>
        <mat-error *ngIf="formulario.get('fechaInicio')?.hasError('futureDate')">La fecha de inicio no puede ser futura</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline" class="w-1/2">
        <mat-label class="text-gray-400 dark:text-gray-400">Hora de Inicio</mat-label>
        <input
          matInput
          type="time"
          formControlName="horaInicio"
          required
          class="bg-gray-800 dark:bg-gray-800 text-gray-100 dark:text-gray-100"
        />
        <mat-hint class="text-gray-100">Formato 24 horas (ej. 18:30)</mat-hint> <!-- Texto ahora será blanco -->
        <mat-error *ngIf="formulario.get('horaInicio')?.hasError('required')">La hora de inicio es obligatoria</mat-error>
      </mat-form-field>
    </div>

    <!-- Campo de fecha y hora de fin (solo para actividades) -->
    <div *ngIf="tipoContenido === 'actividades'" class="flex space-x-4">
      <mat-form-field appearance="outline" class="w-1/2">
        <mat-label class="text-gray-400 dark:text-gray-400">Fecha de Fin</mat-label>
        <input
          matInput
          [matDatepicker]="pickerFin"
          formControlName="fechaFin"
          required
          class="bg-gray-800 dark:bg-gray-800 text-gray-100 dark:text-gray-100"
          (dateChange)="onDateChange('fechaFin', $event)"
        />
        <mat-datepicker-toggle matSuffix [for]="pickerFin" class="text-white">
          <!-- Icono del calendario ahora será blanco -->
        </mat-datepicker-toggle>
        <mat-datepicker #pickerFin></mat-datepicker>
        <mat-error *ngIf="formulario.get('fechaFin')?.hasError('required')">La fecha de fin es obligatoria</mat-error>
        <mat-error *ngIf="formulario.get('fechaFin')?.hasError('invalidEndDate')">La fecha de fin debe ser mayor que la fecha de inicio</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline" class="w-1/2">
        <mat-label class="text-gray-400 dark:text-gray-400">Hora de Fin</mat-label>
        <input
          matInput
          type="time"
          formControlName="horaFin"
          required
          class="bg-gray-800 dark:bg-gray-800 text-gray-100 dark:text-gray-100"
        />
        <mat-hint class="text-white">Formato 24 horas (ej. 19:45)</mat-hint> <!-- Texto ahora será blanco -->
        <mat-error *ngIf="formulario.get('horaFin')?.hasError('required')">La hora de fin es obligatoria</mat-error>
      </mat-form-field>
    </div>

    <!-- Resto del formulario sin cambios -->
    <div [hidden]="tipoContenido !== 'actividades'">
      <mat-form-field appearance="outline" class="w-full">
        <mat-label class="text-gray-400 dark:text-gray-400">Modalidad</mat-label>
        <mat-select formControlName="presencial" [disabled]="esEdicion || tipoContenido !== 'actividades'" [required]="tipoContenido === 'actividades'">
          <mat-option [value]="true">Presencial</mat-option>
          <mat-option [value]="false">Virtual (Subir tarea)</mat-option>
        </mat-select>
        <mat-error *ngIf="formulario.get('presencial')?.hasError('required')">La modalidad es obligatoria</mat-error>
      </mat-form-field>
    </div>

    <div *ngIf="tipoContenido === 'actividades'">
      <mat-form-field appearance="outline" class="w-full">
        <mat-label class="text-gray-400 dark:text-gray-400">Competencia</mat-label>
        <mat-select formControlName="competencia" placeholder="Seleccione una competencia">
          <mat-option *ngFor="let competencia of competencias" [value]="competencia.nombre">
            {{ competencia.nombre }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="formulario.get('competencia')?.hasError('required')">La competencia es obligatoria</mat-error>
      </mat-form-field>
    </div>

    <div class="w-full">
      <label for="archivo" class="block text-gray-400 dark:text-gray-400 mb-2">Archivo* (Formatos válidos: PDF, MP4, AVI, MOV, TXT, DOCX)</label>
      <div class="flex items-center space-x-3">
        <button type="button" (click)="fileInput.click()" class="px-4 py-2 bg-gray-700 dark:bg-gray-700 text-gray-100 dark:text-gray-100 rounded-md hover:bg-gray-600 dark:hover:bg-gray-600 transition-colors duration-300">
          Seleccionar archivo
        </button>
        <input
          #fileInput
          id="archivo"
          type="file"
          (change)="onFileSelected($event)"
          accept=".pdf,.mp4,.avi,.mov,.txt,.docx"
          [required]="!esEdicion"
          class="hidden"
        />
        <span class="text-gray-300 dark:text-gray-300 truncate">
          {{ archivoSeleccionado ? archivoSeleccionado.name : (esEdicion ? getFileNameFromUrl(data.actividad?.actividadUrl) : 'Ningún archivo seleccionado') }}
        </span>
      </div>
    </div>

    <app-alert [message]="alertMessage" [type]="alertType" class="block"></app-alert>
  </form>

  <div *ngIf="cargando" class="overlay">
    <mat-progress-spinner mode="indeterminate" color="primary"></mat-progress-spinner>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end" class="bg-gray-800 dark:bg-gray-800 p-6">
  <button mat-button (click)="cerrarModal()" class="px-4 py-2 bg-gray-800 dark:bg-gray-800 text-white dark:text-white border border-gray-600 dark:border-gray-600 hover:bg-purple-600 dark:hover:bg-purple-600 hover:shadow-lg hover:-translate-y-0.5 rounded-md transition-all duration-300">
    Cancelar
  </button>
  <button mat-raised-button (click)="agregarContenido()" class="px-4 py-2 bg-gray-800 dark:bg-gray-800 text-white dark:text-white border border-gray-600 dark:border-gray-600 rounded-md hover:bg-purple-600 dark:hover:bg-purple-600 hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 shadow-md">
    {{ esEdicion ? 'Guardar Cambios' : 'Agregar' }}
  </button>
</mat-dialog-actions>