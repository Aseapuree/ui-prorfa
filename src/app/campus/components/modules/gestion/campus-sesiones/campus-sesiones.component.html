<div class="p-6">
  <!-- Spinner de carga -->
  <app-general-loading-spinner [visible]="isLoading" [message]="'Cargando sesiones...'"></app-general-loading-spinner>
  <app-breadcrumb [items]="breadcrumbItems"></app-breadcrumb>
  <!-- Título dinámico -->
  <h1 class="text-3xl md:text-4xl font-bold text-gray-100 mb-6 bg-gray-800 bg-opacity-50 border-l-4 border-blue-500 pl-4 py-2 rounded-r-md">
    Sesiones del curso <span class="text-blue-400">{{ cursoNombre }}</span> de {{ grado }} "{{ seccion }}"
  </h1>

  <!-- Mensaje si no hay sesiones -->
  <div *ngIf="sesiones.length === 0" class="text-center text-gray-500">
    No hay sesiones disponibles para este curso.
  </div>

  <!-- Botón Agregar (visible solo para Profesor) -->
  <div class="flex justify-end p-4" *ngIf="rolUsuario === 'Profesor'">
    <div class="bg-white border divide-x rounded-lg overflow-hidden dark:bg-gray-900 dark:border-gray-700 dark:divide-gray-700">
      <button
        (click)="openAddModal()"
        class="flex items-center px-4 py-2 text-sm font-medium text-gray-600 transition-colors duration-200 sm:text-base sm:px-6 dark:hover:bg-gray-800 dark:text-gray-300 gap-x-3 hover:bg-gray-100 w-auto"
      >
        <fa-icon [icon]="['fas', 'plus']" class="w-5 h-5 sm:w-6 sm:h-6"></fa-icon>
        <span>Agregar</span>
      </button>
    </div>
  </div>

  <!-- Tarjetas de sesiones -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5 px-4 py-6">

  <div *ngFor="let sesion of sesiones | slice: (page-1)*itemsPerPage : page*itemsPerPage; let i = index"
       class="flex flex-col bg-white dark:bg-gray-900 rounded-xl shadow-md hover:shadow-xl transition-all duration-300 border border-gray-200 dark:border-gray-700 overflow-hidden h-full min-h-[320px]">

    <!-- Área clickable (contenido principal) -->
    <div class="flex-1 cursor-pointer" (click)="irAActividades(sesion.idSesion!)">
      <app-card-week
        [week]="'Sesión ' + ((page-1)*itemsPerPage + i + 1)"
        [title]="sesion.titulo || 'Nombre de la sesión'"
        [description]="sesion.descripcion || 'Descripción de la clase'"
        [route]="'/card-actividades'"
        [idSesion]="sesion.idSesion"
        [fechaAsignada]="sesion.fechaAsignada"
      ></app-card-week>
    </div>

    <!-- Barra de acciones FIJA en la parte inferior – solo para Profesores -->
    <div *ngIf="rolUsuario === 'Profesor'"
         class="border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/70 flex divide-x divide-gray-200 dark:divide-gray-700 mt-auto">
      
      <button 
        (click)="openEditModal(sesion); $event.stopPropagation()"
        class="flex-1 flex items-center justify-center gap-2 py-3.5 text-sm font-medium text-blue-700 hover:bg-blue-50 dark:text-blue-400 dark:hover:bg-gray-700/60 transition-colors duration-150">
        <fa-icon [icon]="['fas', 'pencil-alt']" class="w-4 h-4"></fa-icon>
        <span class="hidden sm:inline">Editar</span>
      </button>

      <button 
        (click)="eliminarSesion(sesion.idSesion!); $event.stopPropagation()"
        class="flex-1 flex items-center justify-center gap-2 py-3.5 text-sm font-medium text-red-600 hover:bg-red-50 dark:text-red-400 dark:hover:bg-gray-700/60 transition-colors duration-150">
        <fa-icon [icon]="['fas', 'trash-alt']" class="w-4 h-4"></fa-icon>
        <span class="hidden sm:inline">Eliminar</span>
      </button>
    </div>

  </div>
</div>

<!-- Paginación -->
<app-pagination
  *ngIf="sesiones.length > 0 && totalPages > 1"
  [page]="page"
  [totalPages]="totalPages"
  (pageChange)="onPageChange($event)"
></app-pagination>

  <app-notification></app-notification>
</div>